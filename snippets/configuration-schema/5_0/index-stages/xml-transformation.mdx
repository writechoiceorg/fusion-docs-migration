export const schema = {
  "type": "object",
  "title": "XML Transformation",
  "description": "This stage transforms XML contained in a given field on the input document to a new pipeline document with the extracted fields that match the XPath query.  Both the field and the value mapping rules may contain XPath expressions. If both the field and the value contain more than one XPath expression, the stage assumes they are paired.",
  "required": [
    "rootXPath"
  ],
  "properties": {
    "skip": {
      "type": "boolean",
      "title": "Skip This Stage",
      "description": "Set to true to skip this stage.",
      "default": false,
      "hints": [
        "advanced"
      ]
    },
    "label": {
      "type": "string",
      "title": "Label",
      "description": "A unique label for this stage.",
      "hints": [
        "advanced"
      ],
      "maxLength": 255
    },
    "condition": {
      "type": "string",
      "title": "Condition",
      "description": "Define a conditional script that must result in true or false. This can be used to determine if the stage should process or not.",
      "hints": [
        "code",
        "javascript",
        "advanced"
      ]
    },
    "rootXPath": {
      "type": "string",
      "title": "Root XPath",
      "description": "All relative XPath mappings will be made relative to this path."
    },
    "splitOnRoot": {
      "type": "boolean",
      "title": "New Document per Root XPath Match?",
      "description": "If true and there are more than one matches for the root XPath, then each root match will create a new document.  Defaults to true for backwards compatibility reasons.",
      "default": true
    },
    "parentIdField": {
      "type": "string",
      "title": "Parent ID Field Name",
      "description": "Add the parent document's ID onto the new document under this field name."
    },
    "bodyField": {
      "type": "string",
      "title": "Body Field Name",
      "description": "The field containing the XML document to process.",
      "default": "body"
    },
    "outputXMLFragments": {
      "type": "boolean",
      "title": "Output XML Fragments as Strings",
      "description": "If true, then XPath matches that result in a node selection will output the whole node as a String.  If false, just the text content of the node will be output.",
      "default": false
    },
    "mappings": {
      "type": "array",
      "title": "XPath Mappings",
      "description": "The XPath rules to apply to extract content from the designated Body field.  Extractions are added on to the document.",
      "items": {
        "type": "object",
        "required": [
          "xpath",
          "field"
        ],
        "properties": {
          "xpath": {
            "type": "string",
            "title": "Value Expression",
            "description": "The expression for the value of the field.  May be a literal or an XPath.  If it is an XPath expression, it may be relative or absolute.  If relative, it is relative to the root XPath.  If absolute, see the documentation for the rules on how it is processed."
          },
          "field": {
            "type": "string",
            "title": "Field Expression",
            "description": "The name of the field.  May be an XPath entry or a literal.  If it is XPath, then the value that is resolved will be the name of one or more fields. If it is an XPath expression, it may be relative or absolute.  If relative, it is relative to the root XPath.  If absolute, see the documentation for the rules on how it is processed."
          },
          "multivalue": {
            "type": "boolean",
            "title": "Multi Value",
            "description": "If false and there is only one field output: use the first match of the Value Expression as the value entry.  If false and there is more than one field match, then the stage will attempt to match up pairs of fields and values (AKA it acts like a 'zip' function.  If true, then each field will have all matching values.",
            "default": false
          }
        }
      }
    },
    "metadata": {
      "type": "array",
      "title": "Additional Metadata",
      "description": "Pass in any additional key/value pairs to be added to the document.",
      "items": {
        "type": "object",
        "required": [
          "field",
          "value"
        ],
        "properties": {
          "field": {
            "type": "string",
            "title": "Field",
            "description": "The name of the field.  May be an XPath expression.  If it is an XPath expression and the Value is a literal/static value, then the literal value will be used for all fields generated by this mapping."
          },
          "value": {
            "type": "string",
            "title": "Value",
            "description": "The value associated with the field.  May be an XPath expression or a literal string.  Note, literal strings have precedence over XPath expressions.  Practically speaking, this means a bare token (e.g. 'foo') will be treated as a literal and not a match any 'foo' tag XPath expressions.  If you want the latter, use '//foo'."
          }
        }
      }
    },
    "keepParent": {
      "type": "boolean",
      "title": "Keep Parent Document",
      "description": "If true, keep the parent document.  If false, the content extracted from the body field will create one or more new documents.",
      "default": false
    }
  },
  "category": "Document Transformation",
  "categoryPriority": 8,
  "unsafe": false
}
