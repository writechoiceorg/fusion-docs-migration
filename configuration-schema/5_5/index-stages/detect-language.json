{
  "type": "object",
  "title": "Detect Language",
  "description": "Detect the language of the input source fields using https://github.com/optimaize/language-detector. If the output is stored to the document, there will be a new field created for each source field with the language",
  "required": [
    "source",
    "outputType"
  ],
  "properties": {
    "skip": {
      "type": "boolean",
      "title": "Skip This Stage",
      "description": "Set to true to skip this stage.",
      "default": false,
      "hints": [
        "advanced"
      ]
    },
    "label": {
      "type": "string",
      "title": "Label",
      "description": "A unique label for this stage.",
      "hints": [
        "advanced"
      ],
      "maxLength": 255
    },
    "condition": {
      "type": "string",
      "title": "Condition",
      "description": "Define a conditional script that must result in true or false. This can be used to determine if the stage should process or not.",
      "hints": [
        "code",
        "code/javascript",
        "advanced"
      ]
    },
    "source": {
      "type": "array",
      "title": "Source",
      "description": "The fields/context keys to detect on.  May be a String Template. See https://github.com/antlr/stringtemplate4/blob/master/doc/index.md",
      "minItems": 1,
      "items": {
        "type": "string"
      }
    },
    "languages": {
      "type": "array",
      "title": "Languages",
      "description": "The language profiles to use for language detection (in a form of language codes)",
      "items": {
        "type": "object",
        "required": [
          "code"
        ],
        "properties": {
          "code": {
            "type": "string",
            "title": "Language code ",
            "enum": [
              "af",
              "an",
              "ar",
              "ast",
              "be",
              "br",
              "ca",
              "bg",
              "bn",
              "cs",
              "cy",
              "da",
              "de",
              "el",
              "en",
              "es",
              "et",
              "eu",
              "fa",
              "fi",
              "fr",
              "ga",
              "gl",
              "gu",
              "he",
              "hi",
              "hr",
              "ht",
              "hu",
              "id",
              "is",
              "it",
              "ja",
              "km",
              "kn",
              "ko",
              "lt",
              "lv",
              "mk",
              "ml",
              "mr",
              "ms",
              "mt",
              "ne",
              "nl",
              "no",
              "oc",
              "pa",
              "pl",
              "pt",
              "ro",
              "ru",
              "sk",
              "sl",
              "so",
              "sq",
              "sr",
              "sv",
              "sw",
              "ta",
              "te",
              "th",
              "tl",
              "tr",
              "uk",
              "ur",
              "vi",
              "wa",
              "yi",
              "zh-cn",
              "zh-tw"
            ]
          }
        }
      }
    },
    "outputKey": {
      "type": "string",
      "title": "Output Key",
      "description": "The name of the key to insert into the context if the output type is 'context'.  The value is a map of source name to language.  May be a String Template. See https://github.com/antlr/stringtemplate4/blob/master/doc/index.md",
      "default": "languages"
    },
    "documentPostfix": {
      "type": "string",
      "title": "Document Postfix",
      "description": "The postfix to add to the source name when storing the results on the document (via the output type).",
      "default": "_lang"
    },
    "outputType": {
      "type": "string",
      "title": "Output Type",
      "description": "Select whether the flag should be set on the document or in the Pipeline Context.",
      "enum": [
        "document",
        "context"
      ],
      "default": "document"
    },
    "minimumConfidence": {
      "type": "number",
      "title": "Minimum confidence",
      "description": "Minimum confidence score (in range 0 - 1) for a language to be detected. This filters out cases where languages are detected with low confidence.",
      "default": 0.5
    },
    "returnAllMatchedWithConfidenceScores": {
      "type": "boolean",
      "title": "Return all detected languages and their confidence scores.",
      "description": "Return all languages whose confidence scores exceed the minimum and their corresponding confidence scores. By default (unchecked) only the language with the highest confidence score is returned.",
      "default": false
    }
  },
  "category": "Document Filtering and Enrichment",
  "categoryPriority": 8,
  "unsafe": false
}
