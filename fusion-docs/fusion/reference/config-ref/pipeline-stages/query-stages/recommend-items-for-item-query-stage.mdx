---
title: "Recommend Items for Item Stage"
permalink: "514"
---

The Recommend Items for Item query pipeline stage uses signals about users' item choices to recommend related items based on a specific item. Relationships between items can be based on different criteria, such as click patterns, people who bought this also bought that, percentage match of document tags, and so on.

Given an item ID, this stage performs a secondary query to the `COLLECTION_NAME_items_for_item_recommendations` collection to find related items, then retrieves those items from the main collection.

This pipeline stage uses items-for-item recommendations that have been precomputed by the [BPR Recommender](/fusion/5.9/8805/bpr-recommender-jobs).

See also [Items-for-item Recommendations](/fusion/5.9/476/items-for-item-recommendations) to learn how to configure this recommender type and fetch recommendations.

## Prerequisites

Recommendations are not enabled by default. You can enable recommendations using one of the following methods:

* **Collections Manager.** Sign in to Fusion and select your application. Then click **Collections** > **Collections Manager**. Click the gear icon of your collection and select **Enable Recommendations**.

  <Frame>![Enable Recommendations](/assets/images/4.2/recommendations-enable.png)</Frame>

  The system displays the Enable Recommendations dialog box. Click **Enable Recommendations** to automatically enable the [items-for-user](/fusion/5.9/475/methods-for-recommendations-and-boosting#items-for-user) and [items-for-item](/fusion/5.9/475/methods-for-recommendations-and-boosting#items-for-item) recommendation methods. To use additional [recommendation methods](/fusion/5.9/475/methods-for-recommendations-and-boosting), you must configure them separately.
* **Relevance.** Sign in to Fusion and select your application. Then click **Relevance > Recommendations**. The system displays the Enable Recommendations dialog box. Click **Enable Recommendations** to automatically enable the [items-for-user](/fusion/5.9/475/methods-for-recommendations-and-boosting#items-for-user) and [items-for-item](/fusion/5.9/475/methods-for-recommendations-and-boosting#items-for-item) recommendation methods. To use additional [recommendation methods](/fusion/5.9/475/methods-for-recommendations-and-boosting), you must configure them separately.
* **REST API.** Use this command to enable recommendations:

  ```bash
  curl -u USERNAME:PASSWORD -X PUT http://FUSION_HOST:FUSION_PORT/api/collections/COLLECTION_NAME/features/recommendations -H 'content-type: application/json' -d '{"enabled":true}'
  ```

<Note>
When you enable recommendations, Fusion creates a query pipeline that already contains this stage, and that is configured for boosting. The query pipeline is `COLLECTION_NAME_items_for_item_recommendations`.
</Note>

## Using live signals

The **Estimate Recent Results** option uses live signals to augment items-for-user recommendations with real-time recommendations.

When this is enabled, Fusion first looks up items (from previously-generated recommendations) that are similar to the new items. If there are none then it looks up similar users (who also interacted with that item) to get a list of recommendations based on the new items. It then combines those new recommendations with the job-based recommendations already generated for that user (if any), to generate a final list of recommendations.

## Query pipeline stage condition examples

Stages can be triggered conditionally when a script in the **Condition** field evaluates to true.
Some examples are shown below.

Run this stage only for mobile clients:

```js
params.deviceType === "mobile"
```

Run this stage when debugging is enabled:

```js
params.debug === "true"
```

Run this stage when the query includes a specific term:

```js
params.q && params.q.includes("sale")
```

Run this stage when multiple conditions are met:

```js
request.hasParam("fusion-user-name") && request.getFirstParam("fusion-user-name").equals("SuperUser");
!request.hasParam("isFusionPluginQuery")
```

The first condition checks that the request parameter "fusion-user-name" is present and has the value "SuperUser".
The second condition checks that the request parameter "isFusionPluginQuery" is not present.

## Configuration

<Tip>
When entering configuration values in the UI, use *unescaped* characters, such as `\t` for the tab character. When entering configuration values in the API, use *escaped* characters, such as `\\t` for the tab character.
</Tip>



import {SchemaParamFields} from "/snippets/SchemaParamFields.mdx";
import {schema} from "/snippets/configuration-schema/5_9/query-stages/recommend-items-for-item.mdx";

<SchemaParamFields schema={schema}/>
