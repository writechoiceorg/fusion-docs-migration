---
title: "Experiment Stage"
permalink: "528"
---

The Experiment query pipeline stage is part of Fusionâ€™s [Machine Learning](/fusion/5.9/495/machine-learning) framework.

The Machine Learning framework provides tools to evaluate alternative methods of computing and displaying search results. For example, an [experiment](/fusion/5.9/460/experiments) may consist of a system which has two or more different query pipelines running, and users are randomly served search results using some variant of the system via instrumented pages that capture user response. In such a system, the Experiment query stage selects a variant from a running experiment and inject its properties into the current [Context](/fusion-pipeline-javadocs/5.9/?com/lucidworks/apollo/common/pipeline/Context.html).

<Note>
**LucidAcademy**

Lucidworks offers free training to help you get started.

The **Course** for **Experiments** focuses on understanding and running experiments in Fusion:

<Frame>
  <a href="https://academy.lucidworks.com/experiments-course" target="_blank">
    <div class="note-image-wrapper">
      <img noZoom src="/assets/images/training-covers/experiments.jpeg" alt="Experiments" class="note-image" />
      <img noZoom src="/images/play-btn.svg" alt="Play Button" class="note-image-overlay" />
    </div>
  </a>
</Frame>


Visit the [LucidAcademy](https://academy.lucidworks.com) to see the full training catalog.
</Note>


## Query pipeline stage condition examples

Stages can be triggered conditionally when a script in the **Condition** field evaluates to true.
Some examples are shown below.

Run this stage only for mobile clients:

```js
params.deviceType === "mobile"
```

Run this stage when debugging is enabled:

```js
params.debug === "true"
```

Run this stage when the query includes a specific term:

```js
params.q && params.q.includes("sale")
```

Run this stage when multiple conditions are met:

```js
request.hasParam("fusion-user-name") && request.getFirstParam("fusion-user-name").equals("SuperUser");
!request.hasParam("isFusionPluginQuery")
```

The first condition checks that the request parameter "fusion-user-name" is present and has the value "SuperUser".
The second condition checks that the request parameter "isFusionPluginQuery" is not present.

## Configuration

<Tip>
When entering configuration values in the UI, use *unescaped* characters, such as `\t` for the tab character. When entering configuration values in the API, use *escaped* characters, such as `\\t` for the tab character.
</Tip>

import {SchemaParamFields} from "/snippets/SchemaParamFields.mdx";
import {schema} from "/snippets/configuration-schema/5_9/query-stages/experiment-stage.mdx";

<SchemaParamFields schema={schema}/>
