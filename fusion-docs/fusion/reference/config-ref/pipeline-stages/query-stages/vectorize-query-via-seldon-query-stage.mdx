---
title: "Ray/Seldon Vectorize Query Stage"
permalink: "33ccfb"
---

The Ray/Seldon Vectorize Query stage generates a vector based on the current query string (q parameter). In Fusion 5.9.11 and earlier, this stage is called Seldon Vectorize Query.

<Note>
This feature is only available in Fusion 5.9.5 and later versions of Fusion 5.9.
</Note>


For more information on setting up vector search with Ray or Seldon, see [Configure Ray/Seldon vector search](/how-to/p4g61s/configure-ray-seldon-vector-search).

<Tip>
**Important**

This query stage must be placed *before* the **[Solr Query stage](/fusion/5.9/265/solr-query-stage)**.
</Tip>


## Query pipeline stage condition examples

Stages can be triggered conditionally when a script in the **Condition** field evaluates to true.
Some examples are shown below.

Run this stage only for mobile clients:

```js
params.deviceType === "mobile"
```

Run this stage when debugging is enabled:

```js
params.debug === "true"
```

Run this stage when the query includes a specific term:

```js
params.q && params.q.includes("sale")
```

Run this stage when multiple conditions are met:

```js
request.hasParam("fusion-user-name") && request.getFirstParam("fusion-user-name").equals("SuperUser");
!request.hasParam("isFusionPluginQuery")
```

The first condition checks that the request parameter "fusion-user-name" is present and has the value "SuperUser".
The second condition checks that the request parameter "isFusionPluginQuery" is not present.

## Configuration

<Tip>
When entering configuration values in the UI, use *unescaped* characters, such as `\t` for the tab character. When entering configuration values in the API, use *escaped* characters, such as `\\t` for the tab character.
</Tip>

import {SchemaParamFields} from "/snippets/SchemaParamFields.mdx";
import {schema} from "/snippets/configuration-schema/5_9/query-stages/ray---seldon-vectorize-query.mdx";

<SchemaParamFields schema={schema}/>
