---
title: "Managed JavaScript Index Stage"
permalink: "217"
---

This stage runs a JavaScript transformation on documents using a script from the [blob store](/fusion-server/4.2/153/blob-storage). The script must have the blob type `file:js-index`.

See also: [Custom JavaScript Stages For Index Pipelines](/fusion-server/4.2/156/custom-java-script-stages-for-index-pipelines).

## Uploading a JavaScript blob

In Fusion 4.2, JavaScript blobs must be uploaded using the [Blob Store API](/fusion-server/4.2/305/blob-store-api), like this:

```bash
curl -u USERNAME:PASSWORD -X PUT -H 'Content-Type: text/javascript' --data-binary @index-pipeline-js-stage.js http://localhost:8764/api/apps/APP_NAME/blobs/index-pipeline-js-stage.js?resourceType=file:js-index
```

Open the [blob manager](/fusion-server/4.2/153/blob-storage#the-blob-manager) to verify that the new blob is present:

<Frame>![Uploaded JavaScript blob in the blob manager](/assets/images/4.1/known-issue-APOLLO-15672-index.png)</Frame>

## Referencing a JavaScript blob

Use any of the following formats for the `ref`/**Script Reference** configuration field:

```bash
index-pipeline-js-stage.js
```

```bash
blob:index-pipeline-js-stage.js
```

```bash
urn:x-fusion:blob:index-pipeline-js-stage.js
```

<Note>
The examples above use `index-pipeline-js-stage.js` as the blob ID.
</Note>

## Configuration

<Tip>
When entering configuration values in the UI, use *unescaped* characters, such as `\t` for the tab character. When entering configuration values in the API, use *escaped* characters, such as `\\t` for the tab character.
</Tip>

import {SchemaParamFields} from "/snippets/SchemaParamFields.mdx";
import {schema} from "/snippets/configuration-schema/4_2/index-stages/managed-javascript.mdx";

<SchemaParamFields schema={schema}/>
